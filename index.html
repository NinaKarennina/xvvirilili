<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>XV Viri & Lili</title>
  <link rel="icon" type="image/x-icon" href="./images/twinsicon.png" />
  <style>
    html, body { margin: 0; padding: 0; background: #000; color: #fff; }
    main { display:block; }
  </style>
</head>
<body>
  <main id="app"></main>

  <script type="module">
    import { createHeroBlock } from './blocks/hero.js';
    import { createStack }   from './blocks/stack.js';
    import { createCountdown } from './components/countdown.js';
    import { initParallax, initReveal } from './lib/scrollEffects.js';

    const app = document.getElementById('app');

    const registry = {
      countdown: (props) => createCountdown(props),
      // en el futuro puedes agregar otros
    };

    // Define tus bloques como datos (Â¡escalable!)
    const blocks = [
      {
        background:   './images/topbg.webp',
        topLeft:      './images/flowers.webp',
        rightCenter:  './images/lateralflowersrose.webp',
        center:       './images/mainimage.webp',
        bgSpeed: 0.50,
      },
      {
        background:   './images/middlebg.webp',
        leftCenter:   './images/lateralflowersblue.webp',
        bgSpeed: 0.50,
        bgPosition: 0.50,
        stack3: {
          heights: [20,20,10, 10],
          width: "min(90vw,640px)",
          items: [
            { kind:"image", src:"./images/secondview1.webp", alt:"Arriba" },
            { kind:"image", src:"./images/secondview2a.webp",alt:"Abajo" },
            { kind:"image", src:"./images/secondview2b.webp",alt:"Abajo" },
            { kind:"buttonImage", src:"./images/secondview3.webp", alt:"Iglesia", onClick: () => window.open('https://maps.app.goo.gl/GURtuyuBFNBbT698A','_blank') },
          ]
        }
      },
      {
        background:   './images/middlebg.webp',
        rightCenter:  './images/lateralflowersrose.webp',
        bgSpeed: 0.50,
        bgPosition: 0.50,
        stack3: {
          heights: [10,30,0],
          width: "min(90vw,640px)",
          items: [
            { kind:"image", src:"./images/thirdview1.webp", alt:"Arriba" },
            { kind:"image", src:"./images/thirdview2.webp",alt:"Abajo" },
            { kind:"buttonImage", src:"./images/secondview3.webp", alt:"Salon", onClick: () => window.open('https://maps.app.goo.gl/jc2dkAwCwuSifuNR7','_blank') },
          ]
        }
      },
      {
        background:   './images/bottombg.webp',
        leftCenter:  './images/lateralflowersblue.webp',
        rightCenter:  './images/lateralflowersrose.webp',
        bottomCenter: './images/flowersbottomcenter.webp',
        bottomRight:'./images/flowersbottomright.webp',
        bottomLeft:'./images/princessleft.webp',
        bgSpeed: 0.50,
        bgPosition: 1,
        stack3: {
          heights: [15, 20, 10, 1,30],
          width: "min(90vw, 640px)",
          items: [
            { kind: "image", src: "./images/finalview1.webp" },
            { kind: "node",  node: registry.countdown({
              target: '2025-11-08T17:00:00-06:00',
              bgSrc: './images/countdown-bg.webp',
              digitsPath: d => `./digits/${d}.png`,
              zeroPad: { days: 2, hours: 2, minutes: 2, seconds: 2 },
              showLabels: false,
              scaleWidth: 'min(92vw,700px)',
            })},
            { kind: "buttonImage", src: "./images/confirmbutton.webp",
              onClick: () => {} },
            { kind: "image",  src: "./images/finalview2.webp" },
            
          ]
        },
      }
    ];

    // Crea y monta todos los bloques
    const nodes = blocks.map(cfg => {
    // si hay un centerComponent, creamos el nodo
    let centerNode = null;
    if (cfg.centerComponent && registry[cfg.centerComponent]) {
      centerNode = registry[cfg.centerComponent](cfg.centerProps || {});
    }

    // creamos el hero; le pasamos centerNode (o null)
    const sec = createHeroBlock({ ...cfg, centerNode });

    // stack3 (si viene)
    if (cfg.stack3) {
      const s3 = createStack(cfg.stack3);
      sec.appendChild(s3);
    }

    return sec;
  });
    

    app.append(...nodes);
    
    // Efectos de scroll
    // initReveal({ rootMargin: '0px 0px -12% 0px', once: false }); // reversa al hacer scroll back
    initParallax();
  </script>
</body>
</html>
